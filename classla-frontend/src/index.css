@tailwind base;
@tailwind components;
@tailwind utilities;

/* Test if Tailwind is working */
.test-red {
  @apply bg-red-500 text-white p-4;
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 262.1 83.3% 57.8%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 222.2 84% 4.9%;
    --muted: 210 40% 96%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96%;
    --accent-foreground: 222.2 84% 4.9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 262.1 83.3% 57.8%;
    --radius: 0.5rem;
    --editor-heading: 222.2 84% 4.9%;
    --editor-text: 220 13.4% 25.9%;
    --editor-text-secondary: 220 8.9% 46.1%;
    --editor-surface: 210 40% 98%;
    --editor-surface-alt: 220 14.3% 95.9%;
    --editor-border: 220 13% 83%;
  }

  .dark {
    --background: 260 25% 9%;
    --foreground: 260 15% 85%;
    --card: 260 22% 12%;
    --card-foreground: 260 15% 85%;
    --popover: 260 22% 12%;
    --popover-foreground: 260 15% 85%;
    --primary: 262.1 83.3% 57.8%;
    --primary-foreground: 260 15% 95%;
    --secondary: 260 18% 18%;
    --secondary-foreground: 260 15% 85%;
    --muted: 260 18% 18%;
    --muted-foreground: 260 10% 55%;
    --accent: 260 18% 18%;
    --accent-foreground: 260 15% 85%;
    --destructive: 0 62.8% 40%;
    --destructive-foreground: 260 15% 95%;
    --border: 260 18% 20%;
    --input: 260 18% 20%;
    --ring: 262.1 83.3% 57.8%;
    --editor-heading: 260 15% 88%;
    --editor-text: 260 12% 78%;
    --editor-text-secondary: 260 10% 55%;
    --editor-surface: 260 25% 9%;
    --editor-surface-alt: 260 18% 16%;
    --editor-border: 260 18% 22%;
  }
}

@layer base {
  * {
    border-color: hsl(var(--border));
  }
  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
}

/* TipTap Editor List Styles */
@layer components {
  /* Reset prose margins for consistent text styling */
  .assignment-editor-content.prose p,
  .assignment-viewer-content.prose p {
    margin: 0;
  }

  .assignment-editor-content.prose h1,
  .assignment-viewer-content.prose h1,
  .assignment-editor-content.prose h2,
  .assignment-viewer-content.prose h2,
  .assignment-editor-content.prose h3,
  .assignment-viewer-content.prose h3,
  .assignment-editor-content.prose h4,
  .assignment-viewer-content.prose h4,
  .assignment-editor-content.prose h5,
  .assignment-viewer-content.prose h5,
  .assignment-editor-content.prose h6,
  .assignment-viewer-content.prose h6 {
    margin: 0;
  }

  .assignment-editor-content.prose h1:first-child,
  .assignment-viewer-content.prose h1:first-child,
  .assignment-editor-content.prose h2:first-child,
  .assignment-viewer-content.prose h2:first-child,
  .assignment-editor-content.prose h3:first-child,
  .assignment-viewer-content.prose h3:first-child,
  .assignment-editor-content.prose h4:first-child,
  .assignment-viewer-content.prose h4:first-child,
  .assignment-editor-content.prose h5:first-child,
  .assignment-viewer-content.prose h5:first-child,
  .assignment-editor-content.prose h6:first-child,
  .assignment-viewer-content.prose h6:first-child,
  .assignment-editor-content.prose p:first-child,
  .assignment-viewer-content.prose p:first-child {
    margin-top: 0;
  }

  .assignment-editor-content.prose blockquote,
  .assignment-viewer-content.prose blockquote {
    margin: 0;
    padding-left: 1rem;
    border-left: 4px solid hsl(var(--editor-border));
  }

  .assignment-editor-content.prose pre,
  .assignment-viewer-content.prose pre {
    margin: 0;
  }

  .assignment-editor-content.prose hr,
  .assignment-viewer-content.prose hr {
    margin: 0;
  }
  .ProseMirror ul,
  .assignment-editor-content ul,
  .assignment-viewer-content ul,
  .prose ul {
    list-style-type: disc;
    margin-left: 2rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    padding-left: 1rem;
  }

  .ProseMirror ol,
  .assignment-editor-content ol,
  .assignment-viewer-content ol,
  .prose ol {
    list-style-type: decimal;
    margin-left: 2rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    padding-left: 1rem;
  }

  .ProseMirror ul li,
  .assignment-editor-content ul li,
  .assignment-viewer-content ul li,
  .prose ul li {
    display: list-item;
    margin-left: 0;
    padding-left: 0.5rem;
    position: relative;
  }

  .ProseMirror ol li,
  .assignment-editor-content ol li,
  .assignment-viewer-content ol li,
  .prose ol li {
    display: list-item;
    margin-left: 0;
    padding-left: 0.5rem;
    position: relative;
  }

  /* Nested lists */
  .ProseMirror ul ul,
  .assignment-editor-content ul ul,
  .assignment-viewer-content ul ul,
  .prose ul ul {
    list-style-type: circle;
    margin-top: 0.25rem;
    margin-bottom: 0.25rem;
  }

  .ProseMirror ul ul ul,
  .assignment-editor-content ul ul ul,
  .assignment-viewer-content ul ul ul,
  .prose ul ul ul {
    list-style-type: square;
  }

  .ProseMirror ol ol,
  .assignment-editor-content ol ol,
  .assignment-viewer-content ol ol,
  .prose ol ol {
    list-style-type: lower-alpha;
    margin-top: 0.25rem;
    margin-bottom: 0.25rem;
  }

  .ProseMirror ol ol ol,
  .assignment-editor-content ol ol ol,
  .assignment-viewer-content ol ol ol,
  .prose ol ol ol {
    list-style-type: lower-roman;
  }

  /* Task lists */
  .ProseMirror ul[data-type="taskList"],
  .assignment-editor-content ul[data-type="taskList"],
  .assignment-viewer-content ul[data-type="taskList"],
  .prose ul[data-type="taskList"] {
    list-style: none;
    margin-left: 0;
    padding-left: 0;
  }

  .ProseMirror ul[data-type="taskList"] li,
  .assignment-editor-content ul[data-type="taskList"] li,
  .assignment-viewer-content ul[data-type="taskList"] li,
  .prose ul[data-type="taskList"] li {
    display: flex;
    align-items: flex-start;
    margin-left: 0;
    margin-bottom: 0;
    margin-top: 0;
    padding-left: 0;
  }

  .ProseMirror ul[data-type="taskList"] li > label,
  .assignment-editor-content ul[data-type="taskList"] li > label,
  .assignment-viewer-content ul[data-type="taskList"] li > label,
  .prose ul[data-type="taskList"] li > label {
    margin-right: 0.5rem;
    margin-top: 0;
    margin-bottom: 0;
    flex-shrink: 0;
  }

  .ProseMirror ul[data-type="taskList"] li > div,
  .assignment-editor-content ul[data-type="taskList"] li > div,
  .assignment-viewer-content ul[data-type="taskList"] li > div,
  .prose ul[data-type="taskList"] li > div {
    flex: 1;
    margin: 0;
  }

  /* Ensure list markers are visible */
  .ProseMirror,
  .assignment-editor-content,
  .assignment-viewer-content,
  .prose {
    overflow-wrap: break-word;
  }

  /* Consistent ProseMirror content styling */
  .assignment-editor-content .ProseMirror,
  .assignment-viewer-content .ProseMirror {
    outline: none;
  }

  .assignment-editor-content .ProseMirror > *:first-child,
  .assignment-viewer-content .ProseMirror > *:first-child {
    margin-top: 0 !important;
  }

  .assignment-editor-content .ProseMirror > *:last-child,
  .assignment-viewer-content .ProseMirror > *:last-child {
    margin-bottom: 0 !important;
  }

  .assignment-editor-content .ProseMirror p,
  .assignment-viewer-content .ProseMirror p {
    margin: 0;
  }

  .assignment-editor-content .ProseMirror h1,
  .assignment-viewer-content .ProseMirror h1,
  .assignment-editor-content .ProseMirror h2,
  .assignment-viewer-content .ProseMirror h2,
  .assignment-editor-content .ProseMirror h3,
  .assignment-viewer-content .ProseMirror h3,
  .assignment-editor-content .ProseMirror h4,
  .assignment-viewer-content .ProseMirror h4,
  .assignment-editor-content .ProseMirror h5,
  .assignment-viewer-content .ProseMirror h5,
  .assignment-editor-content .ProseMirror h6,
  .assignment-viewer-content .ProseMirror h6 {
    margin: 0;
  }

  .ProseMirror ul,
  .ProseMirror ol,
  .assignment-editor-content ul,
  .assignment-editor-content ol,
  .assignment-viewer-content ul,
  .assignment-viewer-content ol,
  .prose ul,
  .prose ol {
    position: relative;
  }

  /* Force list markers to show - override any resets */
  .ProseMirror ul li::marker,
  .assignment-editor-content ul li::marker,
  .assignment-viewer-content ul li::marker,
  .prose ul li::marker {
    content: "•";
    color: currentColor;
    font-size: 1em;
    font-weight: normal;
  }

  .ProseMirror ol li::marker,
  .assignment-editor-content ol li::marker,
  .assignment-viewer-content ol li::marker,
  .prose ol li::marker {
    color: currentColor;
    font-size: 1em;
    font-weight: 500;
  }

  /* Alternative approach using pseudo-elements if markers don't work */
  .ProseMirror ul:not([data-type="taskList"]) li,
  .assignment-editor-content ul:not([data-type="taskList"]) li,
  .assignment-viewer-content ul:not([data-type="taskList"]) li,
  .prose ul:not([data-type="taskList"]) li {
    position: relative;
  }

  /* Ensure proper spacing and visibility */
  .ProseMirror ul li,
  .ProseMirror ol li,
  .assignment-editor-content ul li,
  .assignment-editor-content ol li,
  .assignment-viewer-content ul li,
  .assignment-viewer-content ol li,
  .prose ul li,
  .prose ol li {
    margin-bottom: 0;
    line-height: 1.6;
  }

  /* Override Tailwind preflight that might be hiding markers */
  .ProseMirror ul,
  .assignment-editor-content ul,
  .assignment-viewer-content ul,
  .prose ul,
  .tiptap-bullet-list {
    list-style: disc outside;
  }

  .ProseMirror ol,
  .assignment-editor-content ol,
  .assignment-viewer-content ol,
  .prose ol,
  .tiptap-ordered-list {
    list-style: decimal outside;
  }

  /* Specific TipTap list styles */
  .tiptap-bullet-list {
    margin-left: 2rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    padding-left: 1rem;
  }

  .tiptap-ordered-list {
    margin-left: 2rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    padding-left: 1rem;
  }

  .tiptap-list-item {
    display: list-item;
    margin-left: 0;
    padding-left: 0.5rem;
    margin-bottom: 0;
    line-height: 1.6;
    position: relative;
  }

  /* Enhanced bullet styling with normal sized, better positioned markers */
  .ProseMirror ul:not([data-type="taskList"]) li::marker,
  .assignment-editor-content ul:not([data-type="taskList"]) li::marker,
  .assignment-viewer-content ul:not([data-type="taskList"]) li::marker,
  .prose ul:not([data-type="taskList"]) li::marker,
  .tiptap-bullet-list .tiptap-list-item::marker {
    content: "•";
    color: hsl(var(--editor-text));
    font-size: 1em;
    font-weight: normal;
  }

  .ProseMirror ol li::marker,
  .assignment-editor-content ol li::marker,
  .assignment-viewer-content ol li::marker,
  .prose ol li::marker,
  .tiptap-ordered-list .tiptap-list-item::marker {
    color: hsl(var(--editor-text));
    font-size: 1em;
    font-weight: 500;
  }

  /* Nested list styling with different bullet types */
  .ProseMirror ul ul li::marker,
  .assignment-editor-content ul ul li::marker,
  .assignment-viewer-content ul ul li::marker,
  .prose ul ul li::marker {
    content: "◦";
    font-size: 1em;
  }

  .ProseMirror ul ul ul li::marker,
  .assignment-editor-content ul ul ul li::marker,
  .assignment-viewer-content ul ul ul li::marker,
  .prose ul ul ul li::marker {
    content: "▪";
    font-size: 1em;
  }
}

/* Rich text content - code block and inline code styles (used in MCQ viewer, etc.) */
.rich-text-content pre {
  background-color: #1e1e1e;
  color: #d4d4d4;
  padding: 0.75rem;
  border-radius: 0.375rem;
  margin: 0.25rem 0;
  overflow-x: auto;
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas,
    "Liberation Mono", Menlo, monospace;
  font-size: 0.875rem;
}

.rich-text-content pre code {
  background: none;
  padding: 0;
  color: inherit;
}

.rich-text-content code {
  background-color: #f3f4f6;
  padding: 0.0625rem 0.25rem;
  border-radius: 0.125rem;
  font-size: 0.875rem;
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas,
    "Liberation Mono", Menlo, monospace;
}

.dark .rich-text-content code {
  background-color: hsl(260 18% 18%);
  color: hsl(260 15% 85%);
}

/* Input autofill dark mode fix */
.dark input:-webkit-autofill,
.dark input:-webkit-autofill:hover,
.dark input:-webkit-autofill:focus {
  -webkit-text-fill-color: hsl(260 15% 85%);
  -webkit-box-shadow: 0 0 0px 1000px hsl(260 25% 9%) inset;
  transition: background-color 5000s ease-in-out 0s;
}

/* Allotment Customization */
:root {
  --focus-border: hsl(var(--primary));
  --separator-border: hsl(var(--border));
}

/* Make the sash more visible and easier to grab */
.split-view .sash {
  background-color: hsl(var(--border));
}

.split-view .sash:hover,
.split-view .sash-hover {
  background-color: rgba(147, 51, 234, 0.3); /* Purple with opacity */
}

.split-view .sash-active {
  background-color: rgba(147, 51, 234, 0.4); /* Darker purple when dragging */
}

/* Dark mode - make separators more visible */
.dark .split-view .sash {
  background-color: hsl(var(--border));
  opacity: 0.8;
}

.dark .split-view .sash:hover,
.dark .split-view .sash-hover {
  background-color: rgba(147, 51, 234, 0.5);
  opacity: 1;
}

.dark .split-view .sash-active {
  background-color: rgba(147, 51, 234, 0.6);
  opacity: 1;
}

/* Increase the hit area for better UX */
.split-view-horizontal > .sash-container > .sash {
  width: 8px;
  margin-left: -4px;
  margin-right: -4px;
}

.split-view-vertical > .sash-container > .sash {
  height: 8px;
  margin-top: -4px;
  margin-bottom: -4px;
}

/* Block drag-to-reorder styles */
.drop-indicator {
  transition: top 0.1s ease-out;
}

.editor-container.is-dragging .ProseMirror > * {
  cursor: grabbing;
}

.editor-container.is-dragging .ProseMirror {
  user-select: none;
}

.drag-ghost {
  position: fixed;
  z-index: 10000;
  padding: 6px 12px;
  background: hsl(var(--card));
  border: 1px solid hsl(var(--border));
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  color: hsl(var(--muted-foreground));
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  pointer-events: none;
  white-space: nowrap;
}

/* AI Generating Block Styling */
.generating-block-content {
  padding: 8px 12px;
  border-radius: 6px;
  background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(59, 130, 246, 0.05) 100%);
}

.ai-generating-text {
  animation: ai-pulse 1.5s ease-in-out infinite;
  color: rgb(147, 51, 234);
  font-weight: 500;
}

@keyframes ai-pulse {
  0%, 100% {
    color: rgb(147, 51, 234);
    opacity: 1;
  }
  50% {
    color: rgb(168, 85, 247);
    opacity: 0.8;
  }
}

